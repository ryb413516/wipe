/*!wipe-ryb1.0.0 发布日期:2018-11-13*/
var moveX,moveY,cas=document.querySelector("#cas"),context=cas.getContext("2d"),_w=cas.width,_h=cas.height,radius=20,isMouseDown=!1,device=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase());console.log(device),console.log(navigator.userAgent);var clickEvtName=device?"touchstart":"mousedown",moveEvtName=device?"touchmove":"mousemove",endEvtName=device?"touchend":"mouseup";function drawMask(e){e.fillStyle="#666",e.fillRect(0,0,_w,_h),e.globalCompositeOperation="destination-out"}function drawPoint(e,t,o){console.log("传递参数的个数:"+arguments.length),e.save(),e.beginPath(),e.arc(t,o,radius,0,2*Math.PI),e.fillStyle="rgb(250,0,0)",e.fill(),e.restore()}function drawLine(e,t,o,n,i){console.log("传递参数的个数:"+arguments.length),e.save(),e.lineCap="round",e.beginPath(),e.moveTo(t,o),e.lineTo(n,i),e.lineWidth=2*radius,e.stroke(),e.restore()}function getTransparencyPercent(e){var t=0,o=e.getImageData(0,0,_w,_h);for(i=0;i<_h;i++)for(j=0;j<_w;j++){var n=4*(_w*i+j)+3;0===o.data[n]&&t++}var a=t/(_w*_h)*100;return console.log(Math.ceil(a)+"%"),a.toFixed(2)}function clearRect(e){e.clearRect(0,0,_w,_h)}function drawT(e,t,o,n,i){if(3===arguments.length)e.save(),e.beginPath(),e.arc(t,o,radius,0,2*Math.PI),e.fillStyle="rgb(250,0,0)",e.fill(),e.restore();else{if(5!==arguments.length)return!1;console.log("传递参数的个数:"+arguments.length),e.save(),e.lineCap="round",e.beginPath(),e.moveTo(t,o),e.lineTo(n,i),e.lineWidth=2*radius,e.stroke(),e.restore()}}cas.addEventListener(clickEvtName,function(e){var t=e||window.event;moveX=device?t.touches[0].clientX:t.clientX,moveY=device?t.touches[0].clientY:t.clientY,drawT(context,moveX,moveY),isMouseDown=!0},!1),cas.addEventListener(moveEvtName,function(e){if(!isMouseDown)return!1;var t=e||window.event;t.preventDefault(),x2=device?t.touches[0].clientX:t.clientX,y2=device?t.touches[0].clientY:t.clientY,drawT(context,moveX,moveY,x2,y2),moveX=x2,moveY=y2},!1),cas.addEventListener(endEvtName,function(e){isMouseDown=!1,50<getTransparencyPercent(context)&&(alert("超过了50%的面积"),clearRect(context))},!1),window.onload=function(){drawMask(context)};